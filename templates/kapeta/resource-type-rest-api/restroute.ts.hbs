//#FILENAME:src/rest/{{type data.metadata.name}}Route.ts:write-always
//
// GENERATED SOURCE - DO NOT EDIT
//
import { RestRoute } from '@kapeta/sdk-rest-route';
import { I{{type data.metadata.name}}RouteService } from "./I{{type data.metadata.name}}RouteService";

export class {{type data.metadata.name}}Route extends RestRoute {

    constructor( service:I{{type data.metadata.name}}RouteService ) {
        super();
        this.initRoutes(service);
    }

    private initRoutes(service:I{{type data.metadata.name}}RouteService) {
    {{#methods data.spec.methods}}
        //{{method methodName}}: Verify the method is available
        if (!service.{{method methodName}}) {
            throw new Error('REST resource service for "{{type ../data.metadata.name}}" is missing method: "{{method methodName}}"');
        }

        //{{method methodName}}: Verify the method is implemented correctly
        this.validateMethod(service.{{method methodName}}, '{{method methodName}}', [
            {{#arguments arguments}}
                '{{variable argumentName}}'
            {{/arguments}}
        ]);

        //{{method methodName}}: Add route to server
        this.addEndpoint(
            {
                method: '{{string method}}',
                path: '{{string path}}',
                description: '{{string description}}',
                arguments: [
                    {{#arguments arguments}}
                        {
                            name: '{{string argumentName}}',
                            transport: '{{string transport}}'
                        }
                    {{/arguments}}
                ],
                handler: service.{{method methodName}}.bind(service)
            }
        );

    {{/methods}}

    }
}